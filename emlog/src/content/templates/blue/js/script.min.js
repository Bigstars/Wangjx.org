!function(a,b,c,d){var e=a(b);a.fn.lazyload=function(f){function g(){var b=0;i.each(function(){var c=a(this);if(!j.skip_invisible||c.is(":visible"))if(a.abovethetop(this,j)||a.leftofbegin(this,j));else if(a.belowthefold(this,j)||a.rightoffold(this,j)){if(++b>j.failure_limit)return!1}else c.trigger("appear"),b=0})}var h,i=this,j={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!0,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return f&&(d!==f.failurelimit&&(f.failure_limit=f.failurelimit,delete f.failurelimit),d!==f.effectspeed&&(f.effect_speed=f.effectspeed,delete f.effectspeed),a.extend(j,f)),h=j.container===d||j.container===b?e:a(j.container),0===j.event.indexOf("scroll")&&h.bind(j.event,function(){return g()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,(c.attr("src")===d||c.attr("src")===!1)&&c.is("img")&&c.attr("src",j.placeholder),c.one("appear",function(){if(!this.loaded){if(j.appear){var d=i.length;j.appear.call(b,d,j)}a("<img />").bind("load",function(){var d=c.attr("data-"+j.data_attribute);c.hide(),c.is("img")?c.attr("src",d):c.css("background-image","url('"+d+"')"),c[j.effect](j.effect_speed),b.loaded=!0;var e=a.grep(i,function(a){return!a.loaded});if(i=a(e),j.load){var f=i.length;j.load.call(b,f,j)}}).attr("src",c.attr("data-"+j.data_attribute))}}),0!==j.event.indexOf("scroll")&&c.bind(j.event,function(){b.loaded||c.trigger("appear")})}),e.bind("resize",function(){g()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&e.bind("pageshow",function(b){b.originalEvent&&b.originalEvent.persisted&&i.each(function(){a(this).trigger("appear")})}),a(c).ready(function(){g()}),this},a.belowthefold=function(c,f){var g;return g=f.container===d||f.container===b?(b.innerHeight?b.innerHeight:e.height())+e.scrollTop():a(f.container).offset().top+a(f.container).height(),g<=a(c).offset().top-f.threshold},a.rightoffold=function(c,f){var g;return g=f.container===d||f.container===b?e.width()+e.scrollLeft():a(f.container).offset().left+a(f.container).width(),g<=a(c).offset().left-f.threshold},a.abovethetop=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollTop():a(f.container).offset().top,g>=a(c).offset().top+f.threshold+a(c).height()},a.leftofbegin=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollLeft():a(f.container).offset().left,g>=a(c).offset().left+f.threshold+a(c).width()},a.inviewport=function(b,c){return!(a.rightoffold(b,c)||a.leftofbegin(b,c)||a.belowthefold(b,c)||a.abovethetop(b,c))},a.extend(a.expr[":"],{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})}(jQuery,window,document),function(a){function c(){a("http://caibaojian.com/wp-content/themes/blue/js/.entry-thumbnail img,img.avatar,img.look").lazyload({effect:"show"}),a("#sidebar img.avatar,#sidebar img.look").lazyload({effect:"show"})}function f(b,c){a.ajax({type:"POST",url:ajaxurl,data:{action:"dmeng_tracker_ajax",type:b,pid:c,wp_nonce:dmengGetCookie("dmeng_check_nonce")},success:function(d){"NonceIsInvalid"===a.trim(d)?(set_dmeng_nonce(),f(b,c)):a("[data-num-views='true']").html(d)},error:function(){f(b,c)}})}function g(b,c){"up"==b&&(a(c).parent().attr("data-votes-up",parseInt(a(c).parent().attr("data-votes-up"))+1),a(c).children(".votes").html(parseInt(a(c).children(".votes").html())+1)),"down"==b&&(a(c).parent().attr("data-votes-down",parseInt(a(c).parent().attr("data-votes-down"))+1),a(c).siblings("a").children(".votes").html(parseInt(a(c).siblings("a").children(".votes").html())-1))}function h(b){var c=a(b).hasClass("up")?"up":"down";g(c,b),a(b).addClass("highlight"),a(b).parent().addClass("disabled")}function i(b,c,d,e){a.ajax({type:"POST",url:ajaxurl,data:{action:"dmeng_vote_ajax",type:b,id:c,vote:d,wp_nonce:dmengGetCookie("dmeng_check_nonce")},success:function(f){"NonceIsInvalid"===a.trim(f)?(set_dmeng_nonce(),i(b,c,d,e)):"ok"===a.trim(f)&&(h(e),dmengSetCookie("dmeng_vote_"+b+"_"+c,d,86400,"/"))},error:function(){i(b,c,d,e)}})}function j(){a(".vote-group").each(function(){if(!a(this).hasClass("disabled")){var b=a(this).attr("data-vote-id"),c="post"==a.trim(a(this).attr("data-vote-type"))?"post":"comment",d=dmengGetCookie("dmeng_vote_"+c+"_"+b);null==d||"up"!=d&&"down"!=d||(a(this).addClass("disabled"),a(this).children("."+d).addClass("highlight"))}})}function k(b,c){a.ajax({type:"POST",url:ajaxurl,data:{action:"dmeng_comment_sticky",post_id:a("#content").attr("data-post-id"),comment_id:b,sticky:c,wp_nonce:dmengGetCookie("dmeng_check_nonce")},success:function(d){"NonceIsInvalid"===a.trim(d)&&(set_dmeng_nonce(),k(b,c))},error:function(){k(b,c)}})}function l(b,c,d){b.remove(),a(".comment-sticky."+c).removeClass("active"),d.next().length<=0&&d.addClass("hide")}function m(b){var c=a(b).parents("li.comment").eq(0),d=c.attr("data-comment-id"),e=a("#sticky-comments"),f=e.children("#sticky-comment-"+d),g=a(".sticky-title");if(f.length>0)return l(f,d,g),k(d,0),void 0;k(d,e.children().length),a(b).addClass("active"),g.hasClass("hide")&&g.removeClass("hide");var h=c.clone(!0);h.find(".children").remove(),h.attr("id","sticky-"+h.attr("id")).removeClass().addClass("comment sticky-comment list-group-item").children(".vote-group").remove(),h.find(".comment-author, .top-level").remove(),h.find(".comment-meta").prepend(h.find("cite").unbind()).children(".comment-sticky").bind({click:function(){l(f,d,g)}});var i=h.find(".comment-meta").children(".comment-reply-link");i.attr("onclick",i.attr("onclick").replace("comment","sticky-comment")),g.after(h),dmengGoLocationHash("#sticky-comments")}function n(d,e,f){a(f).html('<div id="loading">'+b+"</div>"),a.ajax({type:"POST",url:ajaxurl,data:{action:"dmeng_get_comments",post_id:a("#content").attr("data-post-id"),cpage:d,max_page:e,wp_nonce:dmengGetCookie("dmeng_check_nonce")},success:function(b){"NonceIsInvalid"===a.trim(b)&&(set_dmeng_nonce(),n(d,e,f)),b.search("data-comment-id")>0&&(a(f).html(b),c(),j())},error:function(){n(d,e,f)}})}function q(){a(".gift-exchange-modal").addClass("in").show(),p||(a(".gift-exchange-modal").prepend('<div class="modal-backdrop fade in" style="height: '+o+'px"></div>'),p=!0),a("gift-exchange-modal .modal-backdrop").show()}function r(){a(".gift-exchange-modal").removeClass("in").hide(),a("gift-exchange-modal .modal-backdrop").hide()}function s(c){a(c).siblings("button").hide(),a(c).addClass("disabled").append(b),a.ajax({type:"POST",url:ajaxurl,data:{action:"dmeng_exchange_ajax",post_id:a("#content").attr("data-post-id"),wp_nonce:dmengGetCookie("dmeng_check_nonce")},success:function(b){"NonceIsInvalid"===a.trim(b)&&(set_dmeng_nonce(),s(c));var d="";if(b.error)var d=b.error;if(b.success)var d=b.success;a(c).hide(),a(c).parent().prepend('<p class="text-success">'+d+"</p>"),b.success&&location.reload()},error:function(){a(c).siblings("button").show(),a(c).removeClass("disabled").children(".glyphicon-refresh").remove(),alert(dmengTips.error)}})}function t(d,e,f,g){var h=a(d).find('[type="submit"]');h.children(".glyphicon-refresh").remove(),h.addClass("disabled").append(b),a.ajax({type:"POST",url:e,data:f,success:function(b){a(g).html(a(b).find(g).html()),c()},error:function(){h.removeClass("disabled").children(".glyphicon-refresh").remove(),alert(dmengTips.error)}})}function u(){var c=a("#masthead"),d=a("#masthead .header-content"),e=a("#masthead .navbar"),f=d.outerHeight(!0),g=a(window).scrollTop();c.css("height",e.outerHeight()+f),g>=f&&a(window).width()>=768&&e.removeClass("navbar-static-top").addClass("navbar-fixed-top"),f>g&&e.removeClass("navbar-fixed-top").addClass("navbar-static-top")}function v(b){var c="undefined"==typeof a(b).data("pm")?0:a(b).data("pm");a.ajax({type:"POST",url:ajaxurl,data:{action:"dmeng_delete_message",id:b.data("id"),pm:c,wp_nonce:b.data("nonce")},success:function(c){return"NonceIsInvalid"===a.trim(c)?(set_dmeng_nonce(),v(b),void 0):(b.parents("http://caibaojian.com/wp-content/themes/blue/js/li.msg").remove(),void 0)},error:function(){alert(dmengTips.error)}})}var b='<span class="glyphicon glyphicon-refresh rotate"></span>';window.dmengSetCookie=function(a,b,c,d){var e=new Date;e.setTime(e.getTime()+1e3*c),document.cookie=a+"="+escape(b)+(null==c?"":";expires="+e.toGMTString())+(null==d?"":";path="+d)},window.dmengGetCookie=function(a){return document.cookie.length>0&&(c_start=document.cookie.indexOf(a+"="),-1!=c_start)?(c_start=c_start+a.length+1,c_end=document.cookie.indexOf(";",c_start),-1==c_end&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):""},window.dmengGetQueryString=function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),c=window.location.search.substr(1).match(b);return null!=c?unescape(c[2]):null},window.dmengGoLocationHash=function(b){var c=parseInt(a("#masthead .navbar").outerHeight(!0));null!=b&&""!=b&&a(b).length>0&&a("html,body").animate({scrollTop:a(b).offset().top-c},"normal")},a(window).on("hashchange",function(){dmengGoLocationHash(window.location.hash)}),window.set_dmeng_nonce=function(){a.ajax({type:"POST",url:ajaxurl,data:{action:"dmeng_create_nonce"},success:function(b){dmengSetCookie("dmeng_check_nonce",a.trim(b),3600,"/")},error:function(){set_dmeng_nonce()}})},a(document).on("click",".comment-sticky",function(){m(a(this))}),a(document).on("submit","#commentform",function(){a("#commentsubmit").addClass("disabled").append(b),a("#comment-error-alert").fadeOut().html("");var d=a("#commentform").attr("action"),e=a("input[name=author]").val(),f=a("input[name=email]").val(),g=a("input[name=url]").val(),h=a("input[name=comment_post_ID]").val(),i=a("input[name=comment_parent]").val(),j=a("textarea[name=comment]").val(),k=a("input[name=_wp_unfiltered_html_comment_disabled]").val();return a.ajax({type:"POST",url:d,data:{comment_post_ID:h,comment_parent:i,comment:j,_wp_unfiltered_html_comment_disabled:k?k:"",author:e?e:"",email:f?f:"",url:g?g:""},success:function(b){a(".entry-content").html(a(b).find(".entry-content").html()),a("#comments").html(a(b).find("#comments").html()),c()},error:function(b){var c=b.responseText;c.search("#error-page")>0&&(a("#comment-error-alert").html(a.trim(c.match(/<body[^>]*>((.|[\n\r])*)<\/body>/im)[1])).fadeIn(),a("#commentsubmit").removeClass("disabled").children(".glyphicon-refresh").fadeOut())}}),!1}),a("html").on("click",function(b){"undefined"==typeof a(b.target).data("original-title")&&!a(b.target).parents().is("http://caibaojian.com/wp-content/themes/blue/js/.popover.in")}),a(document).on("click",".look-toggle",function(){a("#looks").toggle()}).on("click","#looks li",function(){var b=a("textarea[name=comment]");return b.focus(),b.val(b.val()+"["+a(this).attr("title")+"]"),a("#looks").hide(),!1}),a(document).on("click","#open-privacy-action",function(){a("#privacy-action").toggle("normal"),a("#privacy-comment").val("").focus()}).on("click","#add-privacy-comment",function(){var b=a("#privacy-comment").val();b&&(b="[pem]"+b+"[/pem]");var c=a("textarea[name=comment]");c.focus(),c.val(c.val()+b),a("#privacy-action").hide("normal")}),a(document).on("click","#pagination-comments a",function(){return dmengGoLocationHash("#thread-comments"),n(parseInt(a(this).html()),parseInt(a(this).parent().attr("data-max-page")),"#thread-comments"),dmengGoLocationHash("#thread-comments"),!1}),a(document).on("click",".vote-group a",function(){var b=a(this).parent();if(!b.hasClass("disabled")){var c=b.attr("data-vote-id"),d="post"==a.trim(b.attr("data-vote-type"))?"post":"comment",e=a(this).hasClass("up")?"up":"down";i(d,c,e,this)}}),a(document).on("mouseenter",".vote-group",function(){a(this).attr("data-original-title",function(){return"\u2605 "+a(this).attr("data-votes-up")+" \u2606 "+a(this).attr("data-votes-down")})}),a(document).on("mouseenter",".dropdown",function(){a(window).width()>767&&a(this).addClass("open")}).on("mouseleave",".dropdown",function(){a(window).width()>767&&a(this).removeClass("open")}),a(document).on("click",".dropdown-toggle",function(){a(this).attr("href")&&(window.location=a(this).attr("href"))}),a(document).on("click",".article_index h5",function(){a(this).parent(".article_index").children("ul").toggle()}),a(document).on("click","#dmeng_friend_url",function(){a(this).select()});var o=a(window).height(),p=!1;a(document).on("click",".modal-footer .btn-default",function(){r()}),a(document).on("click",".btn-exchange",function(){return 0==isUserLoggedIn?(window.location.href=loginUrl,void 0):(q(),void 0)}).on("click",".btn-exchange-submit",function(){return 0==isUserLoggedIn?(window.location.href=loginUrl,void 0):(s(a(this)),void 0)}),a(document).on("submit","#pmform",function(){var b="#pmform",c=a(b);return t(b,location.href,{pmNonce:c.find('[name="pmNonce"]').val(),pm:c.find('[name="pm"]').val()},"#content"),!1}),a(document).on("submit","#creditform",function(){var b="#creditform",c=a(b);return t(b,location.href,{creditNonce:c.find('[name="creditNonce"]').val(),creditChange:c.find('[name="creditChange"]:checked').val(),creditNum:c.find('[name="creditNum"]').val(),creditDesc:c.find('[name="creditDesc"]').val()},"#content"),!1}),a(document).on("click",".user-profile .friend",function(){prompt(dmengFriend.title,dmengFriend.url)}),a(document).on("click","#set-font-small",function(){a(this).addClass("disabled"),a(this).siblings("#set-font-big").removeClass("disabled"),a("#content .entry-content").css({"font-size":"14px","line-height":"24px"})}).on("click","#set-font-big",function(){a(this).addClass("disabled"),a(this).siblings("#set-font-small").removeClass("disabled"),a("#content .entry-content").css({"font-size":"16px","line-height":"26px"})}),a(document).on("click","#goTop",function(){a("html,body").animate({scrollTop:"0px"},800)}).on("click","#goBottom",function(){a("html,body").animate({scrollTop:a("#colophon").offset().top},800)}).on("click","#goComments",function(){a("html,body").animate({scrollTop:a("#comments").offset().top},800),a("#comment").focus()}).on("click","#refresh",function(){location.reload()}),a(document).on("click","#author-message li .close",function(){if("undefined"!=typeof a(this).data("id")){var b=confirm(a(this).attr("title")+" ? ");0!=b&&v(a(this))}}),window.dmengready=function(){var b=dmengGetCookie("dmeng_check_nonce");(null==b||""==b)&&set_dmeng_nonce(),dmengGoLocationHash(window.location.hash),j(),u(),dmengGetQueryString("fid")&&dmengSetCookie("dmeng_friend",dmengGetQueryString("fid"),86400,"/"),"undefined"!=typeof dmengTracker&&f(dmengTracker.type,dmengTracker.pid),c(),dmengCodePrettify&&(a(".single .entry-content code").addClass("prettyprint"),prettyPrint())},a(document).ready(function(){0==dmengInstant&&dmengready()}),a(window).resize(function(){u(1)}),a(window).scroll(function(){u()});}(jQuery);var addComment={moveForm:function(a,b,c){var e="#div-"+a,f=jQuery("#commentform .help-block a");return jQuery(e).next("form").length>0?(jQuery(e).find(".comment-reply-link").removeClass("highlight"),jQuery("#comment_parent").val("0"),jQuery("#"+c).append(jQuery("#commentform")),f.length>0&&f.attr("href",f.attr("href").replace(/%23[^/]+$/,"%23"+c))):(jQuery(".comment-reply-link").removeClass("highlight"),jQuery(e).find(".comment-reply-link").addClass("highlight"),jQuery("#comment_parent").val(b),jQuery(e).after(jQuery("#commentform")),f.length>0&&f.attr("href",f.attr("href").replace(/%23[^/]+$/,"%23"+a)),dmengGoLocationHash("#"+a),$("#comment").focus()),!1}};